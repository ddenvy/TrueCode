# üèõÔ∏è TrueCode –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è —ç–∫–æ—Å–∏—Å—Ç–µ–º–∞ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ –≤–∞–ª—é—Ç–Ω—ã–º–∏ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π REST API, gRPC, JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º –∫—É—Ä—Å–æ–≤ –≤–∞–ª—é—Ç.


### üöÄ –°–µ—Ä–≤–∏—Å—ã:
- **üë§ User Service** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏, JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- **üí∞ Finance Service** - –∫—É—Ä—Å—ã –≤–∞–ª—é—Ç, –∏–∑–±—Ä–∞–Ω–Ω—ã–µ –≤–∞–ª—é—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **üåê API Gateway** - –µ–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞, –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è, JWT –≤–∞–ª–∏–¥–∞—Ü–∏—è
- **‚è∞ Currency Updater** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—É—Ä—Å–æ–≤ —Å –¶–ë –†–§
- **üóÑÔ∏è DB Migrator** - —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π –ë–î

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **.NET 8.0/9.0 SDK** - –¥–ª—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –∏ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
- **PostgreSQL** - –æ—Å–Ω–æ–≤–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
- **Visual Studio 2022** –∏–ª–∏ **VS Code** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- **grpcurl** - –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è gRPC (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

1. **–ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è**
   ```bash
   git clone <repository-url>
   cd TrueCode
   ```

2. **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π**
   ```bash
   dotnet restore
   ```

3. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ PostgreSQL**
   
   –°–æ–∑–¥–∞–π—Ç–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞:
   ```sql
   CREATE DATABASE truecode_user;
   CREATE DATABASE truecode_finance;
   ```

4. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ç—Ä–æ–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è**
   
   –û–±–Ω–æ–≤–∏—Ç–µ `appsettings.json` –≤ –∫–∞–∂–¥–æ–º —Å–µ—Ä–≤–∏—Å–µ:
   ```json
   {
     "ConnectionStrings": {
       "DefaultConnection": "Host=localhost;Port=5432;Database=truecode_user;Username=postgres;Password=postgres"
     }
   }
   ```

5. **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–ª–∏ —á–µ—Ä–µ–∑ DbMigrator)**
   
   **–í–∞—Ä–∏–∞–Ω—Ç A: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞**
   ```bash
   # –ú–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ API
   ```
   
   **–í–∞—Ä–∏–∞–Ω—Ç B: –ß–µ—Ä–µ–∑ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å –º–∏–≥—Ä–∞—Ü–∏–π**
   ```bash
   dotnet run --project src/Services/DbMigrator/TrueCode.DbMigrator
   ```

6. **–ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤**

   **üåê API Gateway (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø–µ—Ä–≤—ã–º):**
   ```bash
   dotnet run --project src/Gateway/TrueCode.Gateway
   ```
   - HTTP: `http://localhost:5000`
   - HTTPS: `https://localhost:5002`
   - Swagger UI: `http://localhost:5000/swagger`

   **üë§ User Service:**
   ```bash
   dotnet run --project src/Services/User/TrueCode.User.API
   ```
   - HTTP: `http://localhost:5001`
   - gRPC: `http://localhost:5001`
   - Swagger UI: `http://localhost:5001/swagger`

   **üí∞ Finance Service:**
   ```bash
   dotnet run --project src/Services/Finance/TrueCode.Finance.API
   ```
   - HTTP: `http://localhost:5003`
   - Swagger UI: `http://localhost:5003/swagger`

   **‚è∞ Currency Updater (—Ñ–æ–Ω–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å):**
   ```bash
   dotnet run --project src/Services/CurrencyUpdater/TrueCode.CurrencyUpdater
   ```
   - –û–±–Ω–æ–≤–ª—è–µ—Ç –∫—É—Ä—Å—ã –≤–∞–ª—é—Ç –∫–∞–∂–¥—ã–µ 4 —á–∞—Å–∞
   - –ü–µ—Ä–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–µ—Ä–≤–∏—Å–æ–≤
```bash
# API Gateway
curl http://localhost:5000/health

# User Service  
curl http://localhost:5001/health

# Finance Service
curl http://localhost:5003/health
```

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ API Gateway –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏
```bash
# –ß–µ—Ä–µ–∑ Gateway -> User Service
curl http://localhost:5000/api/user/health

# –ß–µ—Ä–µ–∑ Gateway -> Finance Service  
curl http://localhost:5000/api/finance/health
```

### 3. –ü–æ–ª–Ω—ã–π workflow —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

**–®–∞–≥ 1: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ Gateway**
```bash
curl -X POST "http://localhost:5000/api/user/register" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "testuser",
    "password": "password123"
  }'
```

**–®–∞–≥ 2: –õ–æ–≥–∏–Ω –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ JWT —Ç–æ–∫–µ–Ω–∞**
```bash
curl -X POST "http://localhost:5000/api/user/login" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "testuser", 
    "password": "password123"
  }'
```

**–®–∞–≥ 3: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö –≤–∞–ª—é—Ç**
```bash
curl -X PUT "http://localhost:5000/api/user/favorite-currencies" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "favoriteCurrencies": ["USD", "EUR", "GBP"]
  }'
```

**–®–∞–≥ 4: –ü–æ–ª—É—á–µ–Ω–∏–µ –∫—É—Ä—Å–æ–≤ –≤–∞–ª—é—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ Finance Service**
```bash
curl -X GET "http://localhost:5000/api/finance/user-rates" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN"
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### üèÉ‚Äç‚ôÇÔ∏è –ó–∞–ø—É—Å–∫ Unit-—Ç–µ—Å—Ç–æ–≤

**–ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤:**
```bash
dotnet test --verbosity minimal
```

**–ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ User Service:**
```bash
dotnet test tests/TrueCode.User.Tests/TrueCode.User.Tests.csproj --verbosity minimal
```

**–ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ Finance Service:**
```bash
dotnet test tests/TrueCode.Finance.Tests/TrueCode.Finance.Tests.csproj --verbosity minimal
```

**–ü–æ–¥—Ä–æ–±–Ω—ã–π –≤—ã–≤–æ–¥ —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º:**
```bash
dotnet test --verbosity detailed --collect:"XPlat Code Coverage"
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
‚úÖ TrueCode.User.Tests: 11 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ—à–ª–∏ —É—Å–ø–µ—à–Ω–æ
‚úÖ TrueCode.Finance.Tests: 17 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ—à–ª–∏ —É—Å–ø–µ—à–Ω–æ
üéâ –í—Å–µ–≥–æ: 28 —Ç–µ—Å—Ç–æ–≤ —É—Å–ø–µ—à–Ω–æ
```

### üåê REST API —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ API Gateway

#### 1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```bash
curl -X POST "http://localhost:5000/api/user/register" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "testuser",
    "password": "password123"
  }'
```

#### 2. –í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É
```bash
curl -X POST "http://localhost:5000/api/user/login" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "testuser",
    "password": "password123"
  }'
```

#### 3. –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```bash
curl -X GET "http://localhost:5000/api/user/profile" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN"
```

#### 4. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö –≤–∞–ª—é—Ç
```bash
curl -X PUT "http://localhost:5000/api/user/favorite-currencies" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "favoriteCurrencies": ["USD", "EUR", "GBP"]
  }'
```

#### 5. –ü–æ–ª—É—á–µ–Ω–∏–µ –∫—É—Ä—Å–æ–≤ –≤–∞–ª—é—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```bash
curl -X GET "http://localhost:5000/api/finance/user-rates" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN"
```

#### 6. –ü–æ–ª—É—á–µ–Ω–∏–µ –∫—É—Ä—Å–æ–≤ –≤–∞–ª—é—Ç –¥—Ä—É–≥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–µ—Å–ª–∏ –µ—Å—Ç—å –ø—Ä–∞–≤–∞)
```bash
curl -X GET "http://localhost:5000/api/finance/user-rates/USER_ID" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN"
```

### üöÄ gRPC —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (–º–µ–∂—Å–µ—Ä–≤–∏—Å–Ω–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ)

#### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ grpcurl (–µ—Å–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
```bash
# Windows (—á–µ—Ä–µ–∑ Chocolatey)
choco install grpcurl

# macOS (—á–µ—Ä–µ–∑ Homebrew)  
brew install grpcurl

# Linux
go install github.com/fullstorydev/grpcurl/cmd/grpcurl@latest
```

#### 1. –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ gRPC (User Service)
```bash
grpcurl -plaintext -d '{"userId": "USER_GUID"}' localhost:5001 TrueCode.User.API.Grpc.UserService/GetUser
```

#### 2. –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–∞ —á–µ—Ä–µ–∑ gRPC (User Service)
```bash
grpcurl -plaintext -d '{"token": "YOUR_JWT_TOKEN"}' localhost:5001 TrueCode.User.API.Grpc.UserService/ValidateToken
```

#### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö gRPC –º–µ—Ç–æ–¥–æ–≤
```bash
# –°–ø–∏—Å–æ–∫ —Å–µ—Ä–≤–∏—Å–æ–≤ User Service
grpcurl -plaintext localhost:5001 list

# –û–ø–∏—Å–∞–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤ UserService
grpcurl -plaintext localhost:5001 describe TrueCode.User.API.Grpc.UserService
```

### üé® –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ Swagger UI

#### API Gateway Swagger (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
1. –û—Ç–∫—Ä–æ–π—Ç–µ: `http://localhost:5000/swagger`
2. –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –¥–æ—Å—Ç—É–ø–Ω—ã —á–µ—Ä–µ–∑ –µ–¥–∏–Ω—É—é —Ç–æ—á–∫—É –≤—Ö–æ–¥–∞
3. JWT —Ç–æ–∫–µ–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–∫—Å–∏—Ä—É—é—Ç—Å—è –≤ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã

#### User Service Swagger
1. –û—Ç–∫—Ä–æ–π—Ç–µ: `http://localhost:5001/swagger` 
2. –ü—Ä—è–º–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ User API

#### Finance Service Swagger  
1. –û—Ç–∫—Ä–æ–π—Ç–µ: `http://localhost:5003/swagger`
2. –ü—Ä—è–º–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Finance API

**–ü—Ä–æ—Ü–µ–¥—É—Ä–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ Swagger:**
1. –í—ã–ø–æ–ª–Ω–∏—Ç–µ `/api/user/login` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è JWT —Ç–æ–∫–µ–Ω–∞
2. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "Authorize" –≤ Swagger UI
3. –í–≤–µ–¥–∏—Ç–µ —Ç–æ–∫–µ–Ω –≤ —Ñ–æ—Ä–º–∞—Ç–µ: `Bearer YOUR_JWT_TOKEN`
4. –í—Å–µ –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã –±—É–¥—É—Ç –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ã

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å Clean Architecture –≤ –∫–∞–∂–¥–æ–º —Å–µ—Ä–≤–∏—Å–µ

**üèõÔ∏è –û–±—â–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã:**
- **Database per Service** - –∫–∞–∂–¥—ã–π —Å–µ—Ä–≤–∏—Å –∏–º–µ–µ—Ç —Å–≤–æ—é –ë–î
- **API Gateway** - –µ–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –¥–ª—è –≤—Å–µ—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤
- **Service-to-Service Communication** - gRPC –¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —Å–≤—è–∑–∏
- **JWT Authentication** - —Å–∫–≤–æ–∑–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
- **Background Services** - –¥–ª—è –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞—á

**üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–∞–∂–¥–æ–≥–æ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞ (Clean Architecture):**
- **API Layer**: REST –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã, gRPC —Å–µ—Ä–≤–∏—Å—ã, middleware
- **Application Layer**: CQRS –∫–æ–º–∞–Ω–¥—ã/–∑–∞–ø—Ä–æ—Å—ã, handlers, DTOs, –≤–∞–ª–∏–¥–∞—Ç–æ—Ä—ã
- **Domain Layer**: –î–æ–º–µ–Ω–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏, –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã, –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
- **Infrastructure Layer**: –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏, DbContext, –º–∏–≥—Ä–∞—Ü–∏–∏, –≤–Ω–µ—à–Ω–∏–µ API
- **Shared Layer**: –û–±—â–∏–µ —Å–µ—Ä–≤–∏—Å—ã (JWT, —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π, –±–∞–∑–æ–≤—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏)

**üîÑ –ú–µ–∂—Å–µ—Ä–≤–∏—Å–Ω–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ:**
```
Client Request ‚Üí API Gateway ‚Üí User/Finance Service
Finance Service ‚Üí gRPC ‚Üí User Service (–ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
Currency Updater ‚Üí HTTP ‚Üí CBR.ru API ‚Üí Finance Database
```

**üìä –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫:**
- **.NET 8.0/9.0** - –æ—Å–Ω–æ–≤–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞
- **PostgreSQL** - –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å JSONB –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π  
- **Entity Framework Core** - ORM —Å Code-First –º–∏–≥—Ä–∞—Ü–∏—è–º–∏
- **YARP** - —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π reverse proxy –¥–ª—è API Gateway
- **gRPC** - –≤—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–∞—è –º–µ–∂—Å–µ—Ä–≤–∏—Å–Ω–∞—è —Å–≤—è–∑—å
- **MediatR** - CQRS implementation
- **FluentValidation** - –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **BCrypt** - —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π
- **xUnit + Moq + FluentAssertions** - unit-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### JWT –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (–æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤)
```json
{
  "JwtSettings": {
    "SecretKey": "TrueCodeSuperSecretKeyForJWTTokenGeneration2024!",
    "Issuer": "TrueCode.User.API",
    "Audience": "TrueCode.Client",
    "ExpirationInMinutes": 60
  }
}
```

### –°—Ç—Ä–æ–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ PostgreSQL

**User Service (`src/Services/User/TrueCode.User.API/appsettings.json`):**
```json
{
  "ConnectionStrings": {
    "DefaultConnection": "Host=localhost;Port=5432;Database=truecode_user;Username=postgres;Password=postgres"
  }
}
```

**Finance Service (`src/Services/Finance/TrueCode.Finance.API/appsettings.json`):**
```json
{
  "ConnectionStrings": {
    "DefaultConnection": "Host=localhost;Port=5432;Database=truecode_finance;Username=postgres;Password=postgres"
  },
  "Services": {
    "UserService": {
      "GrpcUrl": "http://localhost:5001"
    }
  }
}
```

**API Gateway (`src/Gateway/TrueCode.Gateway/appsettings.json`):**
```json
{
  "ReverseProxy": {
    "Routes": {
      "user-route": {
        "ClusterId": "user-cluster",
        "Match": { "Path": "/api/user/{**catch-all}" }
      },
      "finance-route": {
        "ClusterId": "finance-cluster",
        "Match": { "Path": "/api/finance/{**catch-all}" }
      }
    },
    "Clusters": {
      "user-cluster": {
        "Destinations": {
          "user-service": { "Address": "http://localhost:5001/" }
        }
      },
      "finance-cluster": {
        "Destinations": {
          "finance-service": { "Address": "http://localhost:5003/" }
        }
      }
    }
  }
}
```

**Currency Updater (`src/Services/CurrencyUpdater/TrueCode.CurrencyUpdater/appsettings.json`):**
```json
{
  "CurrencyUpdate": {
    "IntervalMinutes": 240,
    "EnableOnStartup": true
  },
  "Services": {
    "CbrUrl": "http://www.cbr.ru/scripts/XML_daily.asp"
  }
}
```

## üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ .NET –≤–æ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–∞—Ö:

**üåê API Gateway:**
- –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
- Health check —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
- –û—à–∏–±–∫–∏ –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏—è

**üë§ User Service:**
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- gRPC –≤—ã–∑–æ–≤—ã
- –û–ø–µ—Ä–∞—Ü–∏–∏ —Å –ë–î

**üí∞ Finance Service:**
- –ú–µ–∂—Å–µ—Ä–≤–∏—Å–Ω—ã–µ gRPC –≤—ã–∑–æ–≤—ã –∫ User Service
- –û–ø–µ—Ä–∞—Ü–∏–∏ —Å –≤–∞–ª—é—Ç–∞–º–∏
- –û—à–∏–±–∫–∏ –ø–æ–ª—É—á–µ–Ω–∏—è –∫—É—Ä—Å–æ–≤

**‚è∞ Currency Updater:**
- –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫—É—Ä—Å–æ–≤
- –û—à–∏–±–∫–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞ XML –æ—Ç –¶–ë –†–§
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π

**–£—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è:**
- `Information` - –æ–±—ã—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- `Warning` - –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã
- `Error` - –æ—à–∏–±–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- `Critical` - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Å–±–æ–∏ —Å–∏—Å—Ç–µ–º—ã

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

**üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:**
- **JWT —Ç–æ–∫–µ–Ω—ã** - stateless –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –≤–æ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–∞—Ö
- **BCrypt** - —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π —Å —Å–æ–ª—å—é
- **API Gateway** - —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–æ–≤
- **HTTPS** - —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Ç—Ä–∞—Ñ–∏–∫–∞ (production ready)

**üõ°Ô∏è –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö:**
- **FluentValidation** - server-side –≤–∞–ª–∏–¥–∞—Ü–∏—è
- **Model binding** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è DTOs
- **SQL Injection protection** - —á–µ—Ä–µ–∑ Entity Framework –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
- **XSS protection** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ ASP.NET Core

**üåê –°–µ—Ç–µ–≤–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**
- **CORS** - –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞ cross-origin –∑–∞–ø—Ä–æ—Å–æ–≤
- **Health checks** - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤
- **gRPC TLS** - —à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–∞—è –º–µ–∂—Å–µ—Ä–≤–∏—Å–Ω–∞—è —Å–≤—è–∑—å (–≤ production)

